{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>{% block title %}Cargo –£—á–µ—Ç{% endblock %}</title>

    <link rel="icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    <script defer src="{% static 'js/base.js' %}"></script>
</head>

<body>
<div class="layout">
    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
    <aside class="sidebar">
        <button id="burger" class="burger" onclick="toggleSidebar()">‚ò∞</button>
        <div class="logo-block">
            <img src="{% static 'img/logo.png' %}" alt="Logo" class="logo">
        </div>

        {% if user.is_authenticated %}
            <div class="user-info">
                <span class="username">{{ user.username }}</span>
            </div>

            <nav class="menu">
                <a href="{% url 'index' %}" class="menu-item">üè† –ì–ª–∞–≤–Ω–∞—è</a>
                <a href="{% url 'profile' %}" class="menu-item">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>

                {% if user.role == "Admin" %}
                    <!-- ========== –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ ========== -->
                    <div class="accordion">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            ‚öôÔ∏è –ê–¥–º–∏–Ω–∫–∞
                        </div>
                        <div class="accordion-body">
                            <a href="/cargo_table/" class="menu-item">üì¶ –ì—Ä—É–∑—ã (–≥–ª–∞–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞)</a>
                            <a href="{% url 'orders' %}" class="menu-item">üßæ –ü–µ—Ä–µ–≤–æ–∑–∫–∏ / –Ω–∞–∫–ª–∞–¥–Ω—ã–µ</a>
                            <a href="{% url 'settings_modal' %}" class="menu-item">üè¢ –ö–æ–º–ø–∞–Ω–∏–∏ –∏ –∫–ª–∏–µ–Ω—Ç—ã</a>
                            <a href="/warehouses/" class="menu-item">üèó –°–∫–ª–∞–¥—ã</a>
                            <a href="/payments/" class="menu-item">üí≥ –ü–ª–∞—Ç–µ–∂–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤</a>
                            <a href="{% url 'dashboard' %}" class="menu-item">üìà –û—Ç—á—ë—Ç—ã / –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</a>
                            <a href="{% url 'all_tables' %}" class="menu-item">üìã –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã</a>
                        </div>
                    </div>

                    <!-- ========== –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ ========== -->
                    <div class="accordion">
                        <div class="accordion-header" onclick="toggleAccordion(this)">
                            üìö –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
                        </div>
                        <div class="accordion-body">
                            <a href="/api/get_cargo_types/" class="menu-item">–¢–∏–ø—ã –≥—Ä—É–∑–æ–≤</a>
                            <a href="/api/get_packaging_types/" class="menu-item">–¢–∏–ø—ã —É–ø–∞–∫–æ–≤–æ–∫</a>
                            <a href="/api/get_cargo_statuses/" class="menu-item">–°—Ç–∞—Ç—É—Å—ã –≥—Ä—É–∑–æ–≤</a>
                        </div>
                    </div>
                {% endif %}

                <a href="#" class="menu-item logout" onclick="logoutUser()">üö™ –í—ã—Ö–æ–¥</a>
            </nav>


            <form id="logout-form" method="post" action="{% url 'logout' %}" style="display: none;">
                {% csrf_token %}
            </form>

        {% else %}
            <form class="login-form" method="post" action="{% url 'login' %}">
                {% csrf_token %}
                <h2>–í—Ö–æ–¥</h2>
                <input type="text" name="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>
        {% endif %}
        {% if user.is_authenticated and user.role == "Admin" %}
            <div class="admin-block">
                <button onclick="window.open('/admin/', '_blank')" class="btn">Django Admin</button>
            </div>
        {% endif %}
    </aside>


    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="content">
        {% block content %}
            <div class="placeholder">
                <h1>–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</h1>
                <p>–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ–∑–∂–µ.</p>
            </div>
        {% endblock %}
    </main>
</div>
<script>
    window.onerror = function (message, source, lineno, colno, error) {
        alert("–û—à–∏–±–∫–∞ JS: " + message + " (" + source + ":" + lineno + ")");
    };
</script>
</body>
</html>
